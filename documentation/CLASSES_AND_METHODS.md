# Классы и методы DynStabSpace

## Обнаруженные классы и методы

### Главное приложение

#### App
- **Тип:** Application
- **Namespace:** DynStabSpace
- **Функции:**
  - Инициализация приложения
  - Управление ресурсами
  - Обработка глобальных событий

#### MainWindow
- **Тип:** Window
- **Namespace:** DynStabSpace.MainWindow
- **Компоненты:**
  - `System.Windows.Controls` - элементы управления
  - `System.Windows.Input` - обработка ввода
  - `MouseButtonEventHandler` - обработка событий мыши
  - `MessageBoxButton` - диалоговые окна

### Модули расчетов

#### UostCalc
**Методы:**
- `Calc()` - основной метод расчета установившихся режимов
- `get_Max()` - получение максимальных значений
- `get_Add()` - получение дополнительных параметров

**Лямбда-выражения:**
- `<set_KprInf>b__10_0` - установка коэффициента передачи
- `<get_Max>b__20_0` - получение максимума
- `<get_Add>b__150_0` - получение дополнительных данных

#### TimeKzCalc
**Методы:**
- `Calc()` - основной метод расчета времени короткого замыкания
- `get_TimeKzCalc()` - получение результатов расчета

**Лямбда-выражения:**
- `<get_TimeKzCalc>b__162_0` - получение результатов
- `<get_TimeKzCalc>b__162_1` - дополнительная обработка

#### DynamicCalc
**Методы:**
- `Calc()` - основной метод динамических расчетов
- `get_DynamicCalc()` - получение результатов

**Лямбда-выражения:**
- `<get_DynamicCalc>b__165_0` - получение результатов
- `<get_DynamicCalc>b__165_1` - дополнительная обработка

#### MdpCalc
**Методы:**
- `Calc()` - основной метод расчета МДП
- `get_MdpCalc()` - получение результатов

**Лямбда-выражения:**
- `<get_MdpCalc>b__168_0` - получение результатов
- `<get_MdpCalc>b__168_1` - дополнительная обработка

**Вспомогательные методы:**
- `ResultToFiles()` - сохранение результатов в файлы
- `<ResultToFiles>b__178_0` - обработка сохранения
- `<ResultToFiles>b__178_1` - дополнительная обработка

#### ShuntCalc
**Методы:**
- `Calc()` - основной метод расчета шунтов
- `get_ShuntCalc()` - получение результатов
- `FindShuntKZ()` - поиск шунтов при коротком замыкании

**Лямбда-выражения:**
- `<get_ShuntCalc>b__159_0` - получение результатов
- `<get_ShuntCalc>b__159_1` - дополнительная обработка
- `<FindShuntKZ>b__0` - поиск шунтов

### Утилиты

#### Работа с файлами
**Методы:**
- `FindTemplatePathWithExtension()` - поиск шаблонов файлов
- `<FindTemplatePathWithExtension>b__0` - обработка поиска
- `GetPictures()` - получение изображений
- `<GetPictures>b__0` - обработка получения изображений
- `ResultToFiles()` - сохранение результатов

#### Настройки
**Методы:**
- `get_Settings()` - получение настроек приложения
- `<get_Settings>b__156_0` - обработка получения настроек

### Работа с Excel (EPPlus)

**Классы:**
- `ExcelPackage` - основной класс для работы с Excel
- `ExcelWorkbook` - рабочая книга
- `ExcelWorksheets` - коллекция рабочих листов
- `ExcelWorksheet` - рабочий лист
- `ExcelRange` / `Cells` - ячейки

**Методы:**
- `get_Workbook()` - получение рабочей книги
- `get_Worksheets()` - получение коллекции листов
- `get_Cells()` - получение ячеек
- `FormatCells()` - форматирование ячеек

### Визуализация (OxyPlot)

**Классы:**
- `IPlotModel` - интерфейс модели графика
- `PlotModel` - модель графика
- `PlotView` - представление графика (WPF)
- `Series` - базовый класс серий
- `LineSeries` - линейные графики
- `DataPointSeries` - серии точек данных

**Методы:**
- `get_Series()` - получение коллекции серий
- `MajorGridlineStyle` - стиль основных линий сетки

### Display Classes (Внутренние классы)

#### <>c__DisplayClass150_0
- Вспомогательный класс для лямбда-выражений
- Используется в `get_Add()`

#### <>c__DisplayClass12_0
- Вспомогательный класс для лямбда-выражений
- Используется в расчетах

#### <>c__DisplayClass3_0
- Вспомогательный класс для лямбда-выражений
- Используется в базовых операциях

#### <>c__DisplayClass26_0
- Вспомогательный класс для лямбда-выражений
- Используется в `MdpCalc`

#### <>c__DisplayClass26_1
- Вспомогательный класс для лямбда-выражений
- Дополнительная обработка в `MdpCalc`

#### <>c__DisplayClass27_0
- Вспомогательный класс для лямбда-выражений
- Используется в настройках

### Внутренние поля и свойства

#### <>o__10, <>p__10
- Внутренние поля для кэширования делегатов
- Используются в оптимизации лямбда-выражений

#### <>o__20, <>p__20
- Внутренние поля для кэширования делегатов
- Используются в расчетах

#### <>o__40, <>o__150
- Внутренние поля для кэширования делегатов
- Используются в дополнительных операциях

#### <>p__30, <>p__31
- Внутренние поля для кэширования делегатов
- Используются в промежуточных расчетах

#### <>p__0, <>p__11, <>p__21
- Внутренние поля для кэширования делегатов
- Используются в различных операциях

### VTable Gaps

#### _VtblGap4_10
- Заполнитель в таблице виртуальных методов
- Используется компилятором для выравнивания

#### _VtblGap3_30
- Заполнитель в таблице виртуальных методов
- Используется компилятором для выравнивания

#### _VtblGap2_1
- Заполнитель в таблице виртуальных методов
- Используется компилятором для выравнивания

## Структура вызовов

```
MainWindow
    ↓
ViewModels
    ↓
Calculations
    ├── UostCalc.Calc()
    ├── TimeKzCalc.Calc()
    ├── DynamicCalc.Calc()
    ├── MdpCalc.Calc()
    └── ShuntCalc.Calc()
        ↓
    EPPlus (чтение/запись)
        ↓
    OxyPlot (визуализация)
        ↓
    ResultToFiles()
```

## Паттерны использования

### 1. Лямбда-выражения
Большинство методов используют лямбда-выражения для:
- Обработки данных
- Фильтрации результатов
- Преобразования данных

### 2. Кэширование делегатов
Компилятор создает внутренние поля для кэширования делегатов:
- Оптимизация производительности
- Уменьшение выделения памяти

### 3. Display Classes
Вспомогательные классы для захвата переменных в замыканиях:
- Используются в лямбда-выражениях
- Хранят локальные переменные

## Рекомендации по рефакторингу

### 1. Упрощение лямбда-выражений
- Вынести сложные лямбда-выражения в отдельные методы
- Улучшить читаемость кода

### 2. Удаление Display Classes
- Использовать явные классы вместо замыканий
- Улучшить отладку

### 3. Оптимизация делегатов
- Использовать кэширование делегатов явно
- Улучшить производительность

### 4. Документация методов
- Добавить XML-комментарии к методам
- Описать параметры и возвращаемые значения

## Следующие шаги

1. Декомпилировать код для детального изучения
2. Проанализировать реализацию методов
3. Изучить алгоритмы расчетов
4. Оптимизировать производительность
5. Улучшить структуру кода

