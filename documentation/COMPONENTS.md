# Компоненты приложения DynStabSpace

## Основные компоненты

### 1. Главное приложение (App)

**Файлы:**
- `App.xaml` - ресурсы и настройки приложения
- `App.xaml.cs` - точка входа приложения

**Функции:**
- Инициализация приложения
- Управление ресурсами
- Обработка глобальных событий

### 2. Главное окно (MainWindow)

**Компоненты UI:**
- Элементы управления WPF
- Обработка событий мыши и клавиатуры
- Диалоговые окна (MessageBox)

**Функции:**
- Отображение интерфейса пользователя
- Навигация между модулями
- Управление расчетами

### 3. Модули расчетов

#### 3.1. UostCalc - Расчет установившихся режимов

**Назначение:**
Расчет установившихся режимов работы энергосистемы

**Методы:**
- `Calc()` - основной метод расчета
- `get_Max()` - получение максимальных значений

**Входные данные:**
- Параметры энергосистемы
- Нагрузки
- Генерация

**Выходные данные:**
- Установившиеся параметры
- Напряжения
- Мощности

#### 3.2. TimeKzCalc - Расчет времени короткого замыкания

**Назначение:**
Расчет времени короткого замыкания в энергосистеме

**Методы:**
- `Calc()` - основной метод расчета
- `get_TimeKzCalc()` - получение результатов расчета

**Входные данные:**
- Параметры короткого замыкания
- Характеристики защиты

**Выходные данные:**
- Время срабатывания защиты
- Токи короткого замыкания

#### 3.3. DynamicCalc - Динамические расчеты

**Назначение:**
Расчет динамических процессов в энергосистеме

**Методы:**
- `Calc()` - основной метод расчета
- `get_DynamicCalc()` - получение результатов

**Входные данные:**
- Начальные условия
- Возмущения
- Параметры системы

**Выходные данные:**
- Динамические характеристики
- Переходные процессы

#### 3.4. MdpCalc - Расчет МДП

**Назначение:**
Расчет мгновенных динамических процессов (МДП)

**Методы:**
- `Calc()` - основной метод расчета
- `get_MdpCalc()` - получение результатов

**Временные файлы:**
- `mdp_calc_tmp.rst` - временный файл результатов

**Входные данные:**
- Параметры мгновенных процессов
- Характеристики элементов

**Выходные данные:**
- Мгновенные характеристики
- Временные зависимости

#### 3.5. ShuntCalc - Расчет шунтов

**Назначение:**
Расчет шунтирующих устройств

**Методы:**
- `Calc()` - основной метод расчета
- `get_ShuntCalc()` - получение результатов
- `FindShuntKZ()` - поиск шунтов при коротком замыкании

**Входные данные:**
- Параметры шунтов
- Условия работы

**Выходные данные:**
- Характеристики шунтов
- Параметры компенсации

### 4. Работа с данными

#### 4.1. Excel интеграция (EPPlus)

**Библиотека:** EPPlus.dll

**Основные классы:**
- `ExcelPackage` - пакет Excel файла
- `Workbook` - рабочая книга
- `Worksheet` - рабочий лист
- `Cell` - ячейка

**Функции:**
- Чтение входных данных
- Запись результатов
- Форматирование ячеек
- Создание графиков в Excel

**Формат файлов:**
- `.xlsx` - формат Excel 2007+

#### 4.2. Визуализация (OxyPlot)

**Библиотеки:**
- OxyPlot.dll - основная библиотека
- OxyPlot.Wpf.dll - интеграция с WPF

**Основные классы:**
- `PlotModel` - модель графика
- `PlotView` - представление графика (WPF)
- `Series` - базовый класс серий
- `LineSeries` - линейные графики

**Функции:**
- Построение графиков
- Отображение результатов расчетов
- Настройка стилей
- Экспорт графиков

**Компоненты:**
- `MajorGridlineStyle` - стили сетки
- Легенды
- Подписи осей

### 5. Утилиты

#### 5.1. Работа с файлами

**Методы:**
- `FindTemplatePathWithExtension()` - поиск шаблонов файлов
- `GetPictures()` - получение изображений
- `ResultToFiles()` - сохранение результатов в файлы

**Функции:**
- Поиск файлов по расширению
- Управление путями
- Сохранение результатов

#### 5.2. Настройки

**Методы:**
- `get_Settings()` - получение настроек приложения

**Параметры:**
- Пути к файлам
- Параметры расчетов
- Настройки интерфейса

## Взаимодействие компонентов

```
┌─────────────────┐
│   MainWindow    │
│   (UI Layer)    │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│   ViewModels    │
│  (Logic Layer)  │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  Calculations   │
│ (Business Logic)│
└────────┬────────┘
         │
    ┌────┴────┐
    ▼         ▼
┌────────┐ ┌────────┐
│ EPPlus │ │OxyPlot │
│ (Data) │ │(Viz)   │
└────────┘ └────────┘
```

## Зависимости между компонентами

1. **UI → ViewModels**
   - Привязка данных
   - Команды
   - События

2. **ViewModels → Calculations**
   - Вызов методов расчета
   - Передача параметров
   - Получение результатов

3. **Calculations → EPPlus**
   - Чтение входных данных
   - Запись результатов

4. **Calculations → OxyPlot**
   - Создание графиков
   - Визуализация данных

5. **ViewModels → Utils**
   - Работа с файлами
   - Настройки

## Рекомендации по улучшению компонентов

### Модульность
- Выделить расчеты в отдельные библиотеки
- Создать интерфейсы для расчетов
- Использовать dependency injection

### Тестируемость
- Разделить логику и UI
- Создать unit-тесты для расчетов
- Использовать моки для зависимостей

### Производительность
- Оптимизировать алгоритмы расчетов
- Использовать параллельные вычисления
- Кэшировать результаты

### Расширяемость
- Создать плагинную архитектуру
- Использовать конфигурационные файлы
- Поддержка новых типов расчетов

