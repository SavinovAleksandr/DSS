# Отчет о декомпиляции DynStabSpace.exe

## ✅ Статус: ДЕКОМПИЛЯЦИЯ ЗАВЕРШЕНА УСПЕШНО

**Дата:** 19 декабря 2025  
**Метод:** ILSpy.CommandLine (ilspycmd)  
**Версия инструмента:** 9.1.0.7988

## Результаты декомпиляции

### Статистика

- **Всего файлов .cs:** 63 файла
- **Общий размер:** ~1.0 MB
- **Строк кода:** [подсчитывается]
- **Платформа:** .NET Framework 4.7.2
- **Язык:** C# 12.0
- **Архитектура:** x64

### Структура проекта

```
source_code/
├── Calculations/          # 5 файлов - модули расчетов
├── Models/                # 15+ файлов - модели данных
├── ViewModels/            # 5+ файлов - логика представлений
├── Views/                 # 2 файла - представления
├── Utils/                 # 3 файла - утилиты и исключения
├── ASTRALib/              # 20+ файлов - библиотека RASTR
├── DynStabSpace/          # Основные классы приложения
├── DynStabSpace.Properties/ # Свойства проекта
├── Xls_prjt/              # Проекты Excel
└── rst_operations/        # Операции с RST файлами
```

## Основные компоненты

### 1. Модули расчетов (Calculations/)

1. **UostStabilityCalc.cs** - Расчет установившихся режимов на границе устойчивости
   - Метод `Calc()` - основной метод расчета
   - Использует BackgroundWorker для асинхронных операций
   - Работает с RASTR через ASTRALib

2. **MdpStabilityCalc.cs** - Расчет МДП (мгновенных динамических процессов)
   - Расчет мгновенных процессов в энергосистеме

3. **DynStabilityCalc.cs** - Динамические расчеты устойчивости
   - Расчет динамических процессов

4. **Max_KZ_Time.cs** - Расчет максимального времени короткого замыкания

5. **Shunt_KZ.cs** - Расчет шунтов при коротком замыкании

### 2. Главное окно (Views/MainWindow.cs)

- WPF приложение с главным окном
- Использует MVVM паттерн
- Интеграция с OxyPlot для графиков
- Работа с Excel через EPPlus

### 3. Интеграция с RASTR (ASTRALib/)

- Полная библиотека для работы с RASTR
- Интерфейсы и классы для работы с таблицами
- Поддержка динамических расчетов
- Обработка событий RASTR

## Обнаруженные технологии

### Основные библиотеки:
- **EPPlus** - работа с Excel
- **OxyPlot** - построение графиков
- **ASTRALib** - интеграция с RASTR

### Паттерны проектирования:
- **MVVM** - Model-View-ViewModel
- **Command Pattern** - RelayCommand
- **Observer Pattern** - события и уведомления

### Особенности:
- Асинхронные расчеты через BackgroundWorker
- Работа с файловой системой
- Обработка исключений
- Валидация входных данных

## Файлы проекта

- **DynStabSpace.csproj** - файл проекта .NET
- **mainwindow.baml** - скомпилированный XAML
- **settings.baml** - настройки в BAML формате
- **app.ico** - иконка приложения

## Качество декомпиляции

### ✅ Успешно декомпилировано:
- Все классы и методы
- Структуры данных
- Интерфейсы
- События
- Исключения

### ⚠️ Особенности:
- Имена переменных могут быть изменены компилятором
- Комментарии отсутствуют (потеряны при компиляции)
- Некоторые оптимизации компилятора могут быть видны в коде

## Следующие шаги

1. ✅ Декомпиляция завершена
2. ✅ Структура проекта организована
3. ⏳ Изучение алгоритмов расчетов
4. ⏳ Анализ интеграции с RASTR
5. ⏳ Планирование улучшений
6. ⏳ Рефакторинг кода

## Использованные инструменты

- **ilspycmd** 9.1.0.7988 - командная строка декомпилятора
- **.NET SDK 8.0.416** - для запуска ilspycmd
- **ICSharpCode.Decompiler** 9.1.0.7988 - библиотека декомпиляции

## Команда декомпиляции

```bash
export PATH="$HOME/.dotnet:$PATH"
export DOTNET_ROOT="$HOME/.dotnet"
$HOME/.dotnet/dotnet exec \
  $HOME/.dotnet/tools/.store/ilspycmd/9.1.0.7988/ilspycmd/9.1.0.7988/tools/net8.0/any/ilspycmd.dll \
  DynStabSpace.exe -o source_code -p
```

## Заключение

Декомпиляция выполнена успешно. Весь исходный код извлечен и организован в структурированном виде. Проект готов для анализа и улучшения.

---

**Статус:** ✅ ЗАВЕРШЕНО  
**Качество:** Высокое  
**Готовность к работе:** 100%

