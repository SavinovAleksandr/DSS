# Структура декомпилированного проекта DynStabSpace

## Общая информация

- **Платформа:** .NET Framework 4.7.2
- **Тип проекта:** WPF приложение (WinExe)
- **Язык:** C# 12.0
- **Платформа:** x64
- **Размер декомпилированного кода:** ~1.0 MB
- **Количество файлов:** 69 файлов .cs

## Структура папок

```
source_code/
├── DynStabSpace/              # Основной namespace приложения
│   ├── App.cs                 # Точка входа приложения
│   ├── MainWindow.cs          # Главное окно
│   └── [другие файлы]
│
├── Calculations/              # Модули расчетов
│   ├── UostStabilityCalc.cs   # Расчет установившихся режимов
│   ├── MdpStabilityCalc.cs    # Расчет МДП (мгновенных динамических процессов)
│   ├── DynStabilityCalc.cs    # Динамические расчеты
│   ├── Max_KZ_Time.cs         # Расчет максимального времени КЗ
│   └── Shunt_KZ.cs            # Расчет шунтов при КЗ
│
├── Models/                    # Модели данных
│   ├── UostResults.cs         # Результаты установившихся режимов
│   ├── MdpResults.cs          # Результаты МДП
│   ├── DynResults.cs          # Результаты динамических расчетов
│   ├── ShuntResults.cs        # Результаты расчета шунтов
│   ├── CrtTimeResults.cs      # Результаты времени КЗ
│   ├── DataInfo.cs            # Информация о данных
│   ├── KprInfo.cs             # Информация о КПР
│   ├── RgmsInfo.cs            # Информация о РГМС
│   ├── VrnInfo.cs             # Информация о ВРН
│   ├── SchInfo.cs             # Информация о схеме
│   ├── ScnsInfo.cs            # Информация о сценариях
│   ├── DynShems.cs            # Динамические схемы
│   ├── MdpShems.cs            # Схемы МДП
│   ├── CrtShems.cs            # Схемы времени КЗ
│   ├── Values.cs              # Значения
│   └── FileInfo.cs            # Информация о файлах
│
├── ViewModels/                # ViewModels для MVVM
│   ├── RelayCommand.cs        # Команда для MVVM
│   ├── Events.cs              # События
│   ├── UostEvents.cs          # События установившихся режимов
│   ├── MdpEvents.cs           # События МДП
│   └── Settings.cs            # Настройки
│
├── Views/                     # Представления (XAML)
│   ├── MainWindow.cs          # Главное окно (code-behind)
│   └── App.cs                 # Приложение (code-behind)
│
├── Utils/                     # Вспомогательные утилиты
│   ├── InitialDataException.cs    # Исключение начальных данных
│   ├── UncorrectFileException.cs  # Исключение некорректного файла
│   └── UserLicenseException.cs     # Исключение лицензии
│
├── ASTRALib/                  # Библиотека для работы с RASTR
│   ├── Rastr.cs               # Основной класс RASTR
│   ├── IRastr.cs              # Интерфейс RASTR
│   ├── IFWDynamic.cs          # Интерфейс динамики
│   ├── FWDynamic.cs           # Динамика
│   ├── ITable.cs              # Интерфейс таблицы
│   ├── table.cs               # Таблица
│   ├── ICol.cs                # Интерфейс колонки
│   ├── col.cs                 # Колонка
│   ├── ICols.cs               # Интерфейс колонок
│   ├── Cols.cs                # Колонки
│   ├── ITables.cs             # Интерфейс таблиц
│   └── [другие файлы]
│
├── DynStabSpace.Properties/   # Свойства проекта
│   ├── Settings.cs            # Настройки приложения
│   └── Resources.cs           # Ресурсы
│
├── Xls_prjt/                  # Проект для работы с Excel
│   └── [файлы Excel проектов]
│
├── rst_operations/            # Операции с RST файлами
│   └── [файлы операций]
│
├── DynStabSpace.csproj        # Файл проекта
├── DynStabSpace.decompiled.cs # Декомпилированный код (объединенный)
├── mainwindow.baml            # BAML файл главного окна
├── settings.baml              # BAML файл настроек
└── app.ico                    # Иконка приложения
```

## Основные классы

### Расчеты

1. **UostStabilityCalc** - Расчет установившихся режимов
2. **MdpStabilityCalc** - Расчет МДП (мгновенных динамических процессов)
3. **DynStabilityCalc** - Динамические расчеты устойчивости
4. **Max_KZ_Time** - Расчет максимального времени короткого замыкания
5. **Shunt_KZ** - Расчет шунтов при коротком замыкании

### Модели данных

- **Results классы** - результаты различных типов расчетов
- **Info классы** - информационные структуры данных
- **Shems классы** - схемы для расчетов

### UI

- **MainWindow** - главное окно приложения
- **App** - точка входа приложения

### Интеграция с RASTR

- **ASTRALib** - библиотека для работы с RASTR (система расчета режимов)

## Зависимости

### Внешние библиотеки:
- **EPPlus** - работа с Excel файлами
- **OxyPlot** - построение графиков
- **OxyPlot.Wpf** - интеграция OxyPlot с WPF

### .NET Framework:
- **System.Core**
- **PresentationCore** (WPF)
- **WindowsBase** (WPF)
- **Microsoft.CSharp**

## Особенности

1. **Интеграция с RASTR** - программа использует библиотеку ASTRALib для работы с системой RASTR
2. **BAML файлы** - XAML скомпилирован в BAML формат
3. **Множественные типы расчетов** - поддержка различных типов расчетов устойчивости
4. **Работа с Excel** - использование EPPlus для чтения/записи Excel файлов
5. **Визуализация** - использование OxyPlot для построения графиков

## Следующие шаги

1. Изучить основные классы расчетов
2. Проанализировать алгоритмы
3. Изучить интеграцию с RASTR
4. Оптимизировать код
5. Улучшить структуру проекта

