# Анализ логов и выходных файлов RIDUS

## Дата анализа: 2025-12-25

## 1. Анализ лог-файла

### 1.1. Общая информация
- **Файл**: `logs_RIDUS_25.12.2025 22h45m36s.log`
- **Размер**: 4370 строк
- **Период**: 22:45:36 - 22:55:33 (около 10 минут)

### 1.2. Найденные предупреждения (WARNING)

#### Критические предупреждения:
1. **Не найдены ID линий** (строки 19-22):
   - `Не найден id: 13 -> "В 220 Р-1"!`
   - `Не найден id: 14 -> "В РТД"!`
   - `Не найден id: 15 -> "ВЛ 220 кВ Инта – Воркута"!`
   - `Не найден id: 15 -> "СВ 220 Печора"!`
   - **Влияние**: Могут отсутствовать данные о перетоках в этих линиях

2. **Метод RunEMSMode не найден** (множественные вхождения):
   - `⚠️ Метод RunEMSMode не найден, используется Run()`
   - **Влияние**: Используется альтернативный метод, но расчеты выполняются

3. **Экспорт графиков отключен**:
   - `⚠️ Экспорт графиков отключен: 'Выводить результаты' = 'нет'`
   - **Влияние**: Графики не экспортируются (настройка пользователя)

#### Некритические предупреждения:
- Уменьшение шага при неустойчивости (нормальное поведение алгоритма)

### 1.3. Ошибки (ERROR)
**❌ Критических ошибок не найдено**

### 1.4. Успешные операции
- ✅ Все расчеты завершены успешно
- ✅ Перетоки в сечениях записаны:
  - Печорская ГРЭС – Ухта: 132.96 МВт
  - Ухта – Микунь: 140.14 МВт
  - Микунь – Урдома: -8.50 МВт
  - Печорская ГРЭС – Инта: 45.61 МВт
  - Дефицит ЮЭР_по АТ+Синдор: 144.69 МВт

## 2. Анализ Excel файлов

### 2.1. Файл 1: `Результаты_RIDUS_20251225_224536.xlsx`

**Проблема**: Данные не заполнены полностью

**Характеристики**:
- Размер: 9 строк × 132 столбца
- Заполнено: только базовые поля (№, статус, название файла, схема, Nген)
- **Отсутствуют данные**:
  - Информация о генераторах (колонки 8-12 частично заполнены)
  - Перетоки в сечениях
  - Результаты расчетов ДУ
  - Параметры электростанции

**Что заполнено**:
- Строка 4, колонка 12: `1х210 1х215` (состав генераторов)
- Строка 4, колонка 13: `425` (суммарная мощность?)

**Что НЕ заполнено**:
- Колонки 7-11: Откл. ген., Ген, Pог (пустые)
- Колонки 14+: Перетоки, результаты ДУ (пустые)

### 2.2. Файл 2: `Выходной (4).xlsx`

**Характеристики**:
- Размер: 9 строк × 61 столбец
- Заполнено: **частично** (17-29 столбцов из 61)

**Что заполнено**:
- ✅ Базовые поля (№, статус, название, схема, Nген)
- ✅ Состав генераторов: `1x0+2x0+3x0+4x0+5x0`
- ✅ Суммарная мощность: `0` (странно, должно быть 425?)
- ✅ Результат ДУ: `У` (устойчиво) или `НУ` (неустойчиво)
- ✅ Перетоки в сечениях:
  - Печорская ГРЭС – Ухта: 132.96 МВт
  - Ухта – Микунь: 140.14 МВт
  - Микунь – Урдома: -8.50 МВт
  - Печорская ГРЭС – Инта: 45.61 МВт
  - Дефицит ЮЭР_по АТ+Синдор: 144.69 МВт

**Что НЕ заполнено**:
- Остальные сечения (если их больше)
- Дополнительные параметры

## 3. Сравнение файлов

| Параметр | Файл 1 (Результаты_RIDUS) | Файл 2 (Выходной) |
|----------|---------------------------|-------------------|
| Столбцов | 132 | 61 |
| Строк данных | 6 | 6 |
| Заполнено столбцов | ~5-6 | 17-29 |
| Перетоки | ❌ Нет | ✅ Есть |
| Результаты ДУ | ❌ Нет | ✅ Есть |
| Состав генераторов | ⚠️ Частично | ✅ Есть |
| Суммарная мощность | ⚠️ Частично (425?) | ⚠️ Неверно (0) |

## 4. Выявленные проблемы

### 4.1. Проблема 1: Данные не записываются в файл 1
**Причина**: Код записи в `Результаты_RIDUS_*.xlsx` не заполняет все столбцы
**Решение**: Проверить функцию `_save_results_to_excel` или аналогичную в RIDUS

### 4.2. Проблема 2: Неверная суммарная мощность в файле 2
**Причина**: В файле 2 указано `0 МВт`, хотя должно быть `425 МВт` (210+215)
**Решение**: Проверить расчет суммарной мощности генераторов

### 4.3. Проблема 3: Не найдены ID линий
**Причина**: Линии с ID 13, 14, 15 не найдены в модели
**Решение**: Проверить соответствие ID в настройках и модели

## 5. Рекомендации

1. **Проверить код записи в Excel**:
   - Убедиться, что все данные записываются в правильные столбцы
   - Проверить соответствие индексов столбцов

2. **Исправить расчет суммарной мощности**:
   - Учитывать только включенные генераторы
   - Проверить формулу расчета

3. **Проверить соответствие ID линий**:
   - Убедиться, что все линии из настроек присутствуют в модели
   - Проверить формат ID (число vs строка)

4. **Добавить валидацию данных**:
   - Проверять, что все обязательные поля заполнены
   - Логировать предупреждения о пустых полях

## 6. Выводы

1. ✅ **Расчеты выполнены успешно** - нет критических ошибок
2. ⚠️ **Данные записываются не полностью** - проблема в коде записи Excel
3. ⚠️ **Есть предупреждения** - но они не критичны для работы
4. ✅ **Файл 2 содержит больше данных** - но тоже не полностью заполнен

**Основная проблема**: Код записи результатов в Excel не заполняет все необходимые столбцы, особенно в файле `Результаты_RIDUS_*.xlsx`.

