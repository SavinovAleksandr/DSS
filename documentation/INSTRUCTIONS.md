# Инструкция по анализу и улучшению программы DynStabSpace

## Шаг 1: Декомпиляция программы

### Вариант A: Использование ILSpy GUI (рекомендуется)

1. Откройте приложение ILSpy:
   ```bash
   open /Applications/ILSpy.app
   ```

2. В меню выберите:
   - `File` → `Open`
   - Выберите файл `DynStabSpace.exe`

3. Сохраните исходный код:
   - `File` → `Save Code...`
   - Выберите папку `source_code/`
   - Нажмите `Save`

### Вариант B: Использование ILSpy.CommandLine

1. Установите инструмент:
   ```bash
   dotnet tool install --global ilspycmd
   ```

2. Выполните декомпиляцию:
   ```bash
   ilspycmd DynStabSpace.exe -o source_code/
   ```

### Вариант C: Использование скрипта

```bash
./decompile.sh
```

## Шаг 2: Анализ структуры проекта

После декомпиляции вы получите структуру проекта. Основные компоненты:

- **Models/** - модели данных
- **Views/** - XAML представления
- **ViewModels/** - логика представлений
- **Calculations/** - модули расчетов:
  - `UostCalc.cs` - расчет установившихся режимов
  - `TimeKzCalc.cs` - расчет времени короткого замыкания
  - `DynamicCalc.cs` - динамические расчеты
  - `MdpCalc.cs` - расчет МДП
  - `ShuntCalc.cs` - расчет шунтов

## Шаг 3: Изучение документации

PDF инструкция пользователя находится в файле:
- `Руководство пользователя DSS.pdf`

Изучите документацию для понимания:
- Функциональности программы
- Алгоритмов расчетов
- Форматов входных/выходных данных

## Шаг 4: Анализ кода

### Основные области для анализа:

1. **Архитектура приложения**
   - Паттерны проектирования
   - Структура MVVM
   - Управление состоянием

2. **Алгоритмы расчетов**
   - Математические модели
   - Методы численного решения
   - Оптимизация производительности

3. **Работа с данными**
   - Чтение/запись Excel файлов
   - Обработка входных данных
   - Формирование отчетов

4. **Пользовательский интерфейс**
   - XAML разметка
   - Привязки данных
   - Валидация ввода

## Шаг 5: Планирование улучшений

После анализа определите области для улучшения:

- [ ] Производительность расчетов
- [ ] Пользовательский интерфейс
- [ ] Обработка ошибок
- [ ] Документация кода
- [ ] Тестирование
- [ ] Модульность кода
- [ ] Поддержка новых форматов данных

## Шаг 6: Реализация улучшений

1. Создайте ветку для изменений
2. Внесите улучшения в код
3. Протестируйте изменения
4. Обновите документацию
5. Создайте коммит с описанием изменений

## Полезные инструменты

- **ILSpy** - декомпилятор .NET
- **Visual Studio** / **Rider** - IDE для разработки
- **ReSharper** - анализ кода
- **Git** - контроль версий

